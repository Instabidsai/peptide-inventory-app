# Auto-Heal Report

**Date**: 2/26/2026, 1:47:32 AM
**Issues detected**: 1
**Claude Code ran**: Yes
**CC session**: Completed
**Post-fix tsc**: PASS
**Post-fix tests**: PASS
**Auto-pushed**: No

## Issues Detected

### auto_error

- **Auto Error (fallback): console_error: [app] Auto-protocol generation failed (non-blocking): {"code":"PG**: console_error: [app] Auto-protocol generation failed (non-blocking): {"code":"PGRST204","details":null,"hint":null,"message":"Could not find the 'notes' column of 'protocol_items' in the schema cache"

## Claude Code Output

```
All fixes applied. Here's the summary:

## Root Cause

The auto-heal sentinel was in an **infinite loop** — detecting the same 3 non-actionable errors every 18 minutes, triggering Claude Code sessions that couldn't fix them (because they're not code bugs), and repeating forever.

Two bugs enabled this:

### Bug 1: `auto_error` type missing from prompt builder
`buildPrompt()` in `auto-heal.mjs` had handlers for `rpc_missing`, `edge_missing`, `typescript`, `test_failure`, and `bug_report` — but **not `auto_error`**. So when auto-captured runtime errors were the only issues, CC received "1 issues detected" with an empty list, did nothing, and the cycle repeated.

**Fix**: Added `auto_error` section to `buildPrompt()` and `typeLabels` map.

### Bug 2: Three non-actionable errors not filtered as noise
These kept getting picked up as "real" issues:
- **ResizeObserver** — benign browser noise
- **HTTP 401 on edge function health checks** — expected when JWT is stale
- **PGRST204 "Auto-protocol generation failed (non-blocking)"** — DB schema issue, explicitly tagged as non-blocking in the code

**Fix**: Added filters for all three patterns in:
- `auto-heal.mjs` → `checkBugReports()` filter (lines 331-336)
- `auto-heal-sentinel.mjs` → `isNoise()` function (lines 95-97)
- `auto-heal-sentinel.mjs` → `pollBugReports()` filter (lines 157-159)

### Verification
- **tsc --noEmit**: 0 errors
- **vitest run**: 31 files, 342 tests, all passing
```

