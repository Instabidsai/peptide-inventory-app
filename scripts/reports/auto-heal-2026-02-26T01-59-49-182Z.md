# Auto-Heal Report

**Date**: 2/25/2026, 8:59:49 PM
**Issues detected**: 2
**Claude Code ran**: Yes
**CC session**: Completed
**Post-fix tsc**: PASS
**Post-fix tests**: PASS
**Auto-pushed**: No

## Issues Detected

### auto_error

- **Auto Error (fallback): fetch_error: HTTP 401 : https://mckkegmkpqdicudnfhor.supabase.co/functions/v1/in**: fetch_error: HTTP 401 : https://mckkegmkpqdicudnfhor.supabase.co/functions/v1/invite-user

### Test Failures

- **use-movements.test.ts > useCreateMovement throws when user is not authenticated**: AssertionError: expected false to be true // Object.is equality  Ignored nodes: comments, script, style [36m<html>[39m   [36m<head />[39m   [36m<body>[39m     [36m<div />[39m   [36m</body>[3

## Claude Code Output

```
Both pass. TypeScript has zero errors, and all 11 tests in the file pass (including the previously failing one).

**Summary of fixes:**

1. **`src/hooks/use-movements.ts:276`** â€” Added an explicit `if (!profile) throw new Error('Not authenticated')` check before the `org_id` check. Previously the hook only checked `profile?.org_id`, which conflated "no user" with "no org".

2. **`src/hooks/__tests__/use-movements.test.ts:137`** â€” Changed from mocking `supabase.auth.getUser` (which the hook never calls) to using `setAuthContext({ user: null, profile: null })` which properly simulates unauthenticated state through the auth context the hook actually uses.
```

